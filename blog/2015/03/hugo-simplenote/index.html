<html lang="en">
<head>

  
  <meta charset="utf-8">
  <title>HugoとSimplenoteでgitHub-page</title>
  <meta name="description" content="HugoとSimplenoteでgitHub-page">
  <meta name="author" content="jin">

  
  <meta name="viewport" content="width=device-width, initial-scale=1">


  
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="http://goozenlab.com/css/fonts.css">
  <link rel="stylesheet" href="http://goozenlab.com/css/normalize.css">
  <link rel="stylesheet" href="http://goozenlab.com/css/skeleton.css">
  <link rel="stylesheet" href="http://goozenlab.com/css/custom.css">
  
  
  <script src="http://goozenlab.com/js/highlight.pack.js"></script>
  <link rel="stylesheet" href="http://goozenlab.com/css/tomorrow.css">
  <script>
   hljs.configure({ tabReplace: "  " });
   hljs.initHighlightingOnLoad();
  </script>
  
  
</head>
<body>

<header id="menu">
  <div class="container">
	<span class="logo">goozenlab</span>
	<a>&#9776;</a>
  </div>
</header>

<nav class="navbar">
  <div class="container">
	<div class="row">
	  <div class="ten columns offset-by-one">
		<ul class="">
		  
		  <li class="u-pull-left"> <a href="http://goozenlab.com" class="brand" style="font-weight:bold;font-size:normal"> goozenlab </a></li>
		  <li class="u-pull-right cate"> <a href="http://goozenlab.com/about/" class=""> About </a></li>
		  <li class="u-pull-right cate"> <a href="http://goozenlab.com/categories/nomad" class=""> nomad </a></li>
		  <li class="u-pull-right cate"> <a href="http://goozenlab.com/categories/mac" class=""> mac </a></li>
		  <li class="u-pull-right cate"> <a href="http://goozenlab.com/categories/update" class=""> update </a></li>
		  <li class="u-pull-right cate"> <a href="http://goozenlab.com/categories/web" class=""> web </a></li>
		  <li class="u-pull-right cate"> <a href="http://goozenlab.com/categories/develop" class=""> dev </a></li>
		</ul>
	  </div>
	</div>
  </div>
</nav>


<div class="container post-wrapper">
  <div class="row">
	<div class="eight columns offset-by-two">
	  <div id="post-title">
		<p class="footnote">
		  
		  <time class="">2015-03-13</time>
		  
		  
		  |
		  
		  

		  
		  categories:<a href="http://goozenlab.com/categories/web">web</a> 
		  

		  

		</p>
		<h5>HugoとSimplenoteでgitHub-page</h5>
	  </div>

	  <div class="post">
		

<p>以前は、Octopress+nvALT(SimpleNote Client) でGitHubPageサイトを運用してました。ブログのシステムをHugoに換えたので、nvALTとの連携とデプロイを再設定しました。</p>

<p>Octopressでは rake deploy で一発で github に更新できたのですが、Hugoではスクリプトを使って行います。</p>

<p>まずは、github (githubpage用） と bitbucket (その他のファイル）の登録設定。</p>

<p>（鍵の登録を行っておくとよいです）</p>

<h2 id="github-と-bitbucket-の登録:08d78064a6f6cfd09fd68d36f9666ec4">github と bitbucket の登録</h2>

<pre><code>$ rm -rf public/
$ git init
$ git remote add origin https://YOUR_ACCOUNT@bitbucket.org/YOUR_ACCOUNT/YOUR_REPOSITORY.git
$ git add -A
$ git commit -m &quot;initial commit&quot;
$ git push origin master
Password for 'https://YOUR_ACCOUNT@bitbucket.org':
Counting objects: 166, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (163/163), done.
Writing objects: 100% (166/166), 322.06 KiB | 0 bytes/s, done.
Total 166 (delta 3), reused 0 (delta 0)
To https://YOUR_ACCOUNT@bitbucket.org/YOUR_ACCOUNT/YOUR_REPOSITORY.git
 * [new branch]      master -&gt; master
$ git submodule add https://github.com/YOUR_ACCOUNT/goozenlab.github.io.git public
Cloning into 'public'...
remote: Counting objects: 9437, done.
remote: Compressing objects: 100% (419/419), done.
remote: Total 9437 (delta 271), reused 0 (delta 0), pack-reused 8762
Receiving objects: 100% (9437/9437), 47.41 MiB | 30.00 KiB/s, done.
Resolving deltas: 100% (4319/4319), done.
Checking connectivity... done.
$ 
</code></pre>

<h2 id="プレビュー方法:08d78064a6f6cfd09fd68d36f9666ec4">プレビュー方法</h2>

<p>nvALT:Simplenoteのデータは、ファイル単位として保存しています。保存先をHugo内のpostフォルダーにしてしまうと、そのフォルダー内の<strong>Note &amp; Setting</strong> ファイル（nvALTの設定ファイル？）がサイト構築時にエラーの元になります。</p>

<p><img src="/images/2015-03-11-hugo-alt.png" alt="nvALT:Simplenote" />
</p>

<p>nvALT:SimpleNoteの保存先フォルダーをサイトの外部にし、preview時にrsyncで一方通行の同期を行います。</p>

<p>※ nvALT、あまり知名度が無いように思えるけれどお勧めです。（ctlキーの長押しでプレビューが表示[離すと消える]されたり（数日前に発見！）する。）</p>

<p>これも簡単なスクリプトで行います。<code>hugo server --buildDrafts --theme=default</code> のテーマ部分は自身の設定に合わせてください。</p>

<p><code>hugo_preview.sh</code></p>

<pre><code>#!/bin/bash

echo -e &quot;\033[0;32m---- rsync ----\033[0m&quot;

rsync -avz --delete --exclude 'Notes &amp; Settings' --exclude 'Untitled*' --exclude '.*' /&quot;保存先のフォルダ&quot;/ /&quot;HugoSites&quot;/content/post

echo -e &quot;\033[0;32mhugo preview...\033[0m&quot;

hugo server --buildDrafts --theme=default

</code></pre>

<h2 id="デプロイの方法:08d78064a6f6cfd09fd68d36f9666ec4">デプロイの方法</h2>

<p><code>deploy.sh</code></p>

<pre><code>#!/bin/bash

echo -e &quot;\033[0;32mDeploying updates to GitHub...\033[0m&quot;

# Build the project. 
# if using a theme, replace by `hugo -t &lt;yourtheme&gt;`
hugo

# Go To Public folder
cd public

# Copy CNAME 
# Add changes to git.
git add -A

# Commit changes.
msg=&quot;rebuilding site `date`&quot;
if [ $# -eq 1 ]
  then msg=&quot;$1&quot;
fi
git commit -m &quot;$msg&quot;

# Push source and build repos.
git push origin master

# Come Back
cd ..

</code></pre>

<p>その他のファイルの更新は、タイミングを計って手動でdeployしています。自動でbitbukket にも更新を入れたい時は</p>

<pre><code>echo -e &quot;\033[0;32mDeploying updates to Bitbukket...\033[0m&quot;

git add -A
git commit -m &quot;$msg&quot;
git push origin master
</code></pre>

<p>をdeploy.sh に追加すれば良いのかな。</p>

<p>実行のフラグを付けておしまい。</p>

<pre><code>$ chmod +x deploy.sh
</code></pre>

<p><img src="/images/2015-03-13-pockhara.jpg" alt="Pokhara street" />
</p>

  	  	<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'goozenlabgh';
    var disqus_identifier = 'http:\/\/goozenlab.com\/blog\/2015\/03\/hugo-simplenote\/';
    var disqus_title = 'HugoとSimplenoteでgitHub-page';
    var disqus_url = 'http:\/\/goozenlab.com\/blog\/2015\/03\/hugo-simplenote\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	  </div>
	  
	</div>
  </div>
</div>


<div class="footer">
  <div class="container">
	<div class="row">
	  <div class="ten columns offset-by-one">
		<p class="footnote">
		   Using <a href="http://gohugo.io/">Hugo</a> with nofancy theme. Hosted on githubPage.
		  
		  All right reserved by <a href="mailto:goozenlab@gmail.com">jin.khorog.tajikstan</a>.
		  
		  
		</p>
	  </div>
	</div>
  </div>
</div>


<script src="http://goozenlab.com/js/jquery.min.js" type="text/javascript"></script>
<script src="http://goozenlab.com/js/jquery.timeago.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function(){
    $("time.timeago").timeago();
  })
  $("#menu").click(function(){
    $(".brand").text("HOME");
    $(".navbar ul li").removeClass("cate");
    $(".navbar").toggle();
  });
  $(window).resize(function(){
    if(window.innerWidth > 768) {
      $(".navbar").removeAttr("style");
    }
  });
</script>

</body>
</html>

