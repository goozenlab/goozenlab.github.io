<!DOCTYPE html>
<html lang="en">
<head>

  
  <meta charset="utf-8">
  <title>画面のグレー/カラーのスイッチ - goozenlab</title>
  <meta name="description" content="画面のグレー/カラーのスイッチ">
  <meta name="author" content="jin">

  
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/fonts.css">
  
  
  <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.1/build/pure-min.css" integrity="sha384-CCTZv2q9I9m3UOxRLaJneXrrqKwUNOzZ6NGEUMwHtShDJ+nCoiXJCAgi05KfkLGY" crossorigin="anonymous">
  
  
    <link rel="stylesheet" href="https://unpkg.com/purecss@0.6.1/build/grids-responsive-min.css">
  
  <link rel="stylesheet" href="/css/custom.css">

  
  
  <link rel="stylesheet" href="/highlight/styles/default.css">
  
  <script src="/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <meta name="generator" content="Hugo 0.47" />
  
</head>
<body>

<div class="header pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="desktop pure-menu pure-menu-horizontal nav-menu">
            
            <a href="/" class="site-title pure-menu-heading">goozenlab</a>
            <ul class="pure-menu-list">
				
                <li class="pure-menu-item">
                    <a href="/about/" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
        <div class="mobile pure-menu nav-menu">
            <a href="/" class="pure-menu-heading" id="toggle-home">goozenlab</a>
            <a href="#" id="toggle-btn">&#9776;</a>
            <ul class="pure-menu-list" id="toggle-content" style="display:none;">
                
				
                <li class="pure-menu-item">
                    <a href="/about" class="pure-menu-link">About</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>

<div class="pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
	<div class="pure-u-11-12 pure-u-md-5-8">
        <div class="post">

            <div class="post-title">
                <p class="footnote">
                    <time class="">2013-02-25</time>
		            
                    
                    |
                    
                    

                    
                    categories:<a href="/categories/tips">Tips</a> <a href="/categories/mac">mac</a> 
                    

                    
                </p>
                <h1>画面のグレー/カラーのスイッチ</h1>
            </div>

            <div class="post-content">
                

<p>最近、ディスプレイを白黒（グレースケール）の表示にしています。そのためグラフィックの作業をする時や、ウェブサイトをカラーで見たい時等はカラーでとシステム環境に出たり入ったりする機会が増えました。</p>

<p>ただ一連の作業がちょっと面倒なので、<strong>アップルスクリプト</strong>＋Alfredを使って作業を簡略化しました。</p>

<p>まずはアップルスクリプトエディタでスクリプトを書きます。色々と調べて割と大変だったのですが仕上がってみるとすごくシンプルです。</p>

<p><strong>※</strong> MountainLionにて動かしてます。SnowLeopardではシステム環境のレイアウトが違ったはずなのでちょっと修正が必要だと思います。</p>

<!-- more -->

<pre><code>
tell application &quot;System Preferences&quot;
    activate
    set current pane to pane &quot;com.apple.preference.universalaccess&quot;
end tell

tell application &quot;System Events&quot;
    tell first window of process &quot;System Preferences&quot;
        
        tell table 1 of scroll area 1
            set selected of row 2 to true
        end tell
        tell group 1
            click checkbox &quot;Use grayscale&quot;
        end tell
        
    end tell
end tell

do shell script &quot;terminal-notifier -message \&quot;Color mode has been changed.\&quot; -title \&quot;Diplay\&quot;&quot;

tell application &quot;System Preferences&quot; to quit

</code></pre>

<p>画面上のパーツをどういう風に書いてよいのか分からず四苦八苦しましたが（９行〜１４行目）、下記のコードを走らせる事でGUIのパーツをリスト化してくれます。</p>

<pre><code>tell application &quot;System Preferences&quot;
    activate
    set current pane to pane &quot;com.apple.preference.universalaccess&quot;
    --  set current pane to pane &quot;com.apple.preference.sound&quot;
end tell


tell application &quot;System Events&quot;
    if UI elements enabled then
        tell process &quot;System Preferences&quot;
            get every UI element
            --tell tab group 1 of window &quot;Sound&quot; of application process &quot;System Preferences&quot; of application &quot;System Events&quot;
            tell window 1 of application process &quot;System Preferences&quot; of application &quot;System Events&quot;
                --  tell table 1 of scroll area 1 of window 1 of application process &quot;System Preferences&quot; of application &quot;System Events&quot; これで左にあるテーブルの情報が見れます
                get every UI element
                get every UI element of every UI element
            end tell
        end tell
    else
        tell application &quot;System Preferences&quot;
            activate
            set current pane to pane &quot;com.apple.preference.universalaccess&quot;
            display dialog &quot;UI element scripting is not enabled.&quot;
        end tell
    end if
end tell
</code></pre>

<p><img src="/images/2013-02-25-checkUIElements.png" alt="UIElement" /></p>

<p><code>checkbox &quot;Use grayscale&quot; of group 1 of window &quot;Accessibility&quot; of application process &quot;System Preferences&quot; of application &quot;System Events&quot;</code>でこのgroup 1の&rdquo;Use grayscale&rdquo;をクリックすれば良い事が分かります。表記の仕方がいくつかあるようで、click checkbox &ldquo;Use grayscale&rdquo;はclick checkbox 2、window &ldquo;Accessibility&rdquo;はwindow 1, first windowでも動きます。</p>

<p>後はそのパーツに値を入れてあげれば良し。</p>

<p>そして、スクリプトエディターからプログラムとして保存します。私は~/Library/Scriptsに保存してます。そして、お勧めランチャーのアルフレッドに~/Library/Scriptsを登録します。私の環境では以前やって登録したような、、、問題なく動いてます。</p>

<p>スクリプトで登録して、スクリプトメニューバーから操作も可能です。スクリプトエディターの環境設定にメニューバー登録の設定の箇所があります。</p>

<p>アップルスクリプトでいろんな事が出来るのにちょっと驚きです。</p>

<p>ただ、、別にコンピューターの処理速度が遅い訳ではないでしょうが、バシッとは変わらず</p>

<p>、、、トッ（環境設定が立ち上がり）、、、、、（ちょっと心配になる）、、パッ 。</p>

<p>と変わります。この間は一体？？動きの遅いおじいちゃんのようです。しかもアプリケーションで保存したもののほうがなぜか遅いです。ちょっと気が抜けます。</p>

<h2 id="おまけ">おまけ</h2>

<p>ドックにアップルスクリプトのアイコンが出てくるのがちょっと、と思う方は、アプリケーションのパッケージ内にある<code>Info.plist</code>に</p>

<pre><code class="language-plain">    &lt;key&gt;LSUIElement&lt;/key&gt;
    &lt;true/&gt;
</code></pre>

<p>を追加すると、ドックにアプリケーションのアイコンは表示されません。</p>

<p>そしてついでにノーティフィケーションセンターに登録。terminal-notifierというソフトをつかいます。アップルスクリプトに</p>

<pre><code>do shell script &quot;terminal-notifier -message \&quot;Color mode has been changed.\&quot; -title \&quot;Diplay\&quot;&quot;
</code></pre>

<p>を追加して、ノーティフィケーションセンターに告知します。インストールと簡単な使い方の説明はマイナビニュースの<a href="http://news.mynavi.jp/column/osxhack/060/index.html">こちらの記事</a>を参照してください。</p>

<p>お次ぎはUSBオーディオの選択/解除かな。。</p>

            </div>
        </div>
	</div>
    <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>

<div class="footer pure-g">
    <div class="pure-u-1-24 pure-u-md-5-24"></div>
    <div class="pure-u-11-12 pure-u-md-5-8">
        <div class="footer-content">
		  <div class="pure-menu pure-menu-horizontal">
              <ul>
			      
                  <li class="pure-menu-heading" id="foot-name">jin:</li>
                  
				  
                  
                  <li class="pure-menu-item">
                      <a href="mailto:goozenlab@gmail.com" class="pure-menu-link">Email</a>
                  </li>
                  
          
                  
          
                  
          
                  
          
                  
                  <li class="pure-menu-item">
                      <a href="https://twitter.com/goozenlab" class="pure-menu-link">Twitter</a>
                  </li>
                  
          
              </ul>
              <a href="#" class="pure-menu-heading pull-right" id="gototop-btn">↑↑</a>
          </div>
		  
		  <p id="foot-copyright">Copyright 2018, goozenlab; all rights reserved.</p>
		  
		</div>
	  </div>
      <div class="pure-u-1-24 pure-u-md-1-6"></div>
</div>


<script src="/js/jquery.min.js" type="text/javascript"></script>
<script src="/js/jquery.timeago.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function(){
    $("time.timeago").timeago();
  })
  $("#toggle-btn").click(function(){
    $("#toggle-content").toggle();
    if($(this).html() === "☰") {
        $(this).html("X")
    } else {
        $(this).html("☰")
    }
  });
  $(window).resize(function(){
    if(window.innerWidth > 768) {
      $(".desktop").removeAttr("style");
    }
  });
</script>

</body>
</html>

